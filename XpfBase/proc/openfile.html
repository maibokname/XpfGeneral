<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="Experimental Fortran Package - Base Modules and Classes">
    <meta name="author" content="Niranama" >
    <link rel="icon" href="../favicon.png">

    <title>OpenFile &ndash; eXPerimental Fortran Library (XpfLib) Documentation</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
      <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.7.0.slim.min.js" integrity="sha256-tG5mcZUtJsZvyKAxYLVXrmjKBVLd6VpVccqz/r4ypFE=" crossorigin="anonymous"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">eXPerimental Fortran Library (XpfLib) Documentation </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>OpenFile
      <small>Function</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip"
                 data-bs-placement="bottom" data-html="true"
                 title=" 0.5% of total for procedures.">62 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/MBase_IOHandlers.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/mbase_iohandlers.f90.html'>MBase_IOHandlers.f90</a></li>
                <li class="breadcrumb-item"><a href='../module/mbase_iohandlers.html'>MBase_IOHandlers</a></li>
            <li class="breadcrumb-item active" aria-current="page">OpenFile</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-bs-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/openfile.html#src">OpenFile</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public  function OpenFile(Name, Append, DirAcc, RecLen) result(IOUnit)  
</h2>
    

    <p>To open a file associated with the specified name for both reading and writing.
  A valid (positive) unit number is return if the specified file is opened successfully.
  Otherwise, it is set to -1. <br>
------------------------------------------------------------------------------ <br>
<strong>Important note</strong>: <br>
  Using this routine requires a careful consideration
  according to the technical notes below. <br>
------------------------------------------------------------------------------ <br>
<strong>Technical Notes</strong>: <br>
(1) If the specified file does not exists, a new file will be opened and
  the argument Append is ignored. <br>
(2) If the specified file exists and currently is open, all optional arguments
  are ignored and the unit number associated with it will be returned. <br>
(3) If the specified file exists (but is not open) and Append is not present,
  the existing file will be open with "AsIs" position.  Both DirAcc and RecLen arguments
  are ignored since, for an existing file, existing access mode and format will be retained. <br>
(4) If the specified file exists (but is not open) and Append is present and true,
  the existing file will be opened with "Append" position. Both DirAcc and RecLen arguments
  are ignored since, for an existing file, existing access mode and format will be retained. <br>
(5) If the specified file exists (but is not open) and Append is present and false,
  the existing file will be deleted and a file with the same name will be open as a
  new file. That is the existing one is replaced by the new one. <br>
(5.1) However, If DirAcc is present and true but RecLen is NOT specified, the existing
  file will be left as it is, and the unit number is set to -1.</p>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-name~5"></span>
              character(kind=kChar, len=*),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Name</strong></td>
            <td>
                <p>file name</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-append~2"></span>
              logical,
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Append</strong></td>
            <td>
                <p>flag indicating the file position <br>
- true if the file is positioned at its terminal point <br>
- false if the file is positioned at its initial point <br>
- default = FalseVal</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-diracc~4"></span>
              logical,
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>DirAcc</strong></td>
            <td>
                <p>flag indicating access mode <br>
- true if requesting direct access mode <br>
- false if requesting sequential access mode <br>
- default = FalseVal <br>
For direct access mode, the file is opened for an unformatted file. <br>
For sequential access mode, the file is opened for a formatted file.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-reclen~4"></span>
              integer(kind=kInt32),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>RecLen</strong></td>
            <td>
                <p>(fixed) length of records for direct access mode. <br>
 If DirAcc is present and true, RecLen must be specified.</p>
            </td>
        </tr>
    </tbody>
  </table>

      <h3>Return Value
        <small>
          <span class="anchor" id="variable-iounit~5"></span>
          integer(kind=kInt32)
        </small>
      </h3>
      <p>unit number</p>
    <br>


    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="k">FUNCTION </span><span class="n">OpenFile</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span><span class="n">Append</span><span class="p">,</span><span class="n">DirAcc</span><span class="p">,</span><span class="n">RecLen</span><span class="p">)</span><span class="w"> </span><span class="k">RESULT</span><span class="p">(</span><span class="n">IOUnit</span><span class="p">)</span>

<span class="c">!** PURPOSE OF THIS FUNCTION:</span>
<span class="w">    </span><span class="c">!^  To open a file associated with the specified name for both reading and writing.</span>
<span class="w">    </span><span class="c">!   A valid (positive) unit number is return if the specified file is opened successfully.</span>
<span class="w">    </span><span class="c">!   Otherwise, it is set to -1. &lt;br&gt;</span>
<span class="w">    </span><span class="c">! ------------------------------------------------------------------------------ &lt;br&gt;</span>
<span class="w">    </span><span class="c">! **Important note**: &lt;br&gt;</span>
<span class="w">    </span><span class="c">!   Using this routine requires a careful consideration</span>
<span class="w">    </span><span class="c">!   according to the technical notes below. &lt;br&gt;</span>
<span class="w">    </span><span class="c">! ------------------------------------------------------------------------------ &lt;br&gt;</span>
<span class="w">    </span><span class="c">! **Technical Notes**: &lt;br&gt;</span>
<span class="w">    </span><span class="c">! (1) If the specified file does not exists, a new file will be opened and</span>
<span class="w">    </span><span class="c">!   the argument Append is ignored. &lt;br&gt;</span>
<span class="w">    </span><span class="c">! (2) If the specified file exists and currently is open, all optional arguments</span>
<span class="w">    </span><span class="c">!   are ignored and the unit number associated with it will be returned. &lt;br&gt;</span>
<span class="w">    </span><span class="c">! (3) If the specified file exists (but is not open) and Append is not present,</span>
<span class="w">    </span><span class="c">!   the existing file will be open with &quot;AsIs&quot; position.  Both DirAcc and RecLen arguments</span>
<span class="w">    </span><span class="c">!   are ignored since, for an existing file, existing access mode and format will be retained. &lt;br&gt;</span>
<span class="w">    </span><span class="c">! (4) If the specified file exists (but is not open) and Append is present and true,</span>
<span class="w">    </span><span class="c">!   the existing file will be opened with &quot;Append&quot; position. Both DirAcc and RecLen arguments</span>
<span class="w">    </span><span class="c">!   are ignored since, for an existing file, existing access mode and format will be retained. &lt;br&gt;</span>
<span class="w">    </span><span class="c">! (5) If the specified file exists (but is not open) and Append is present and false,</span>
<span class="w">    </span><span class="c">!   the existing file will be deleted and a file with the same name will be open as a</span>
<span class="w">    </span><span class="c">!   new file. That is the existing one is replaced by the new one. &lt;br&gt;</span>
<span class="w">    </span><span class="c">! (5.1) However, If DirAcc is present and true but RecLen is NOT specified, the existing</span>
<span class="w">    </span><span class="c">!   file will be left as it is, and the unit number is set to -1.</span>

<span class="c">!** FUNCTION ARGUMENT DEFINITIONS:</span>
<span class="w">    </span><span class="n">tCharStar</span><span class="p">,</span><span class="w">          </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">Name</span><span class="w">     </span><span class="c">!! file name</span>
<span class="w">    </span><span class="n">tLogical</span><span class="p">,</span><span class="w"> </span><span class="k">OPTIONAL</span><span class="p">,</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">Append</span>
<span class="w">    </span><span class="c">!^  flag indicating the file position &lt;br&gt;</span>
<span class="w">    </span><span class="c">! - true if the file is positioned at its terminal point &lt;br&gt;</span>
<span class="w">    </span><span class="c">! - false if the file is positioned at its initial point &lt;br&gt;</span>
<span class="w">    </span><span class="c">! - default = FalseVal</span>
<span class="w">    </span><span class="n">tLogical</span><span class="p">,</span><span class="w"> </span><span class="k">OPTIONAL</span><span class="p">,</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">DirAcc</span>
<span class="w">    </span><span class="c">!^  flag indicating access mode &lt;br&gt;</span>
<span class="w">    </span><span class="c">! - true if requesting direct access mode &lt;br&gt;</span>
<span class="w">    </span><span class="c">! - false if requesting sequential access mode &lt;br&gt;</span>
<span class="w">    </span><span class="c">! - default = FalseVal &lt;br&gt;</span>
<span class="w">    </span><span class="c">! For direct access mode, the file is opened for an unformatted file. &lt;br&gt;</span>
<span class="w">    </span><span class="c">! For sequential access mode, the file is opened for a formatted file.</span>
<span class="w">    </span><span class="n">tSInt32</span><span class="p">,</span><span class="w">  </span><span class="k">OPTIONAL</span><span class="p">,</span><span class="w"> </span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">RecLen</span>
<span class="w">    </span><span class="c">!^  (fixed) length of records for direct access mode. &lt;br&gt;</span>
<span class="w">    </span><span class="c">!   If DirAcc is present and true, RecLen must be specified.</span>
<span class="w">    </span><span class="n">tSInt32</span><span class="w">                         </span><span class="kd">::</span><span class="w"> </span><span class="n">IOUnit</span><span class="w">   </span><span class="c">!! unit number</span>
<span class="w">     </span>
<span class="c">!** FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<span class="w">    </span><span class="n">tLogical</span><span class="w">            </span><span class="kd">::</span><span class="w"> </span><span class="n">Sequential</span>
<span class="w">    </span><span class="n">tSInt32</span><span class="w">             </span><span class="kd">::</span><span class="w"> </span><span class="n">iStat</span>
<span class="w">    </span><span class="n">tCharLen</span><span class="p">(</span><span class="n">MsgLen</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">cMsg</span>

<span class="c">!** FLOW</span>

<span class="w">    </span><span class="c">! set defaults, check the input</span>
<span class="w">    </span><span class="n">Sequential</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TrueVal</span>
<span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">DirAcc</span><span class="p">))</span><span class="w"> </span><span class="n">Sequential</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">DirAcc</span>
<span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="nb">LEN_TRIM</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">        CALL </span><span class="n">Output_Message</span><span class="p">(</span><span class="s1">&#39;---      WARNING ERROR MESSAGE     ---&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">CALL </span><span class="n">Output_Message</span><span class="p">(</span><span class="s1">&#39;The specified name is an empty string.&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">CALL </span><span class="n">Output_Message</span><span class="p">(</span><span class="s1">&#39;--------------------------------------&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="n">IOUnit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">        </span><span class="k">RETURN</span>
<span class="k">    END IF</span>
<span class="k">    </span>
<span class="k">    IF</span><span class="w"> </span><span class="p">(</span><span class="n">DoesFileExist</span><span class="p">(</span><span class="n">Name</span><span class="p">))</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">        IF</span><span class="w"> </span><span class="p">(</span><span class="n">IsFileOpen</span><span class="p">(</span><span class="n">Name</span><span class="p">))</span><span class="w"> </span><span class="k">THEN</span>
<span class="w">            </span><span class="c">! technical note #2</span>
<span class="w">            </span><span class="n">IOUnit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetFileIOUnit</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
<span class="w">        </span><span class="k">ELSE</span>
<span class="k">            IF</span><span class="w"> </span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">Append</span><span class="p">))</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                IF</span><span class="w"> </span><span class="p">(</span><span class="n">Append</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="w">                    </span><span class="c">! technical note #4</span>
<span class="w">                    </span><span class="n">IOUnit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetNewIOUnit</span><span class="p">()</span>
<span class="w">                    </span><span class="k">OPEN</span><span class="p">(</span><span class="n">UNIT</span><span class="o">=</span><span class="n">IOUnit</span><span class="p">,</span><span class="w"> </span><span class="k">FILE</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Name</span><span class="p">),</span><span class="w"> </span><span class="n">STATUS</span><span class="o">=</span><span class="s1">&#39;OLD&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">ACTION</span><span class="o">=</span><span class="s1">&#39;READWRITE&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                         </span><span class="n">POSITION</span><span class="o">=</span><span class="s1">&#39;APPEND&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">iStat</span><span class="p">,</span><span class="w"> </span><span class="n">IOMSG</span><span class="o">=</span><span class="n">cMsg</span><span class="p">)</span>
<span class="w">                </span><span class="k">ELSE</span>
<span class="w">                    </span><span class="c">! technical note #5</span>
<span class="w">                    </span><span class="k">IF</span><span class="w"> </span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Sequential</span><span class="p">.</span><span class="nb">AND</span><span class="p">..</span><span class="nb">NOT</span><span class="p">.</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">RecLen</span><span class="p">))</span><span class="w"> </span><span class="k">THEN</span>
<span class="w">                        </span><span class="c">! technical note #5.1</span>
<span class="w">                        </span><span class="k">CALL </span><span class="n">Output_Message</span><span class="p">(</span><span class="s1">&#39;---               WARNING ERROR MESSAGE              ---&#39;</span><span class="p">)</span>
<span class="w">                        </span><span class="k">CALL </span><span class="n">Output_Message</span><span class="p">(</span><span class="s1">&#39;DirAcc is present and true, but RecLen is not specified.&#39;</span><span class="p">)</span>
<span class="w">                        </span><span class="k">CALL </span><span class="n">Output_Message</span><span class="p">(</span><span class="s1">&#39;--------------------------------------------------------&#39;</span><span class="p">)</span>
<span class="w">                        </span><span class="n">IOUnit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">                        </span><span class="k">RETURN</span>
<span class="k">                    END IF</span>
<span class="k">                    IF</span><span class="w"> </span><span class="p">(</span><span class="n">Sequential</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="w">                        </span><span class="c">! replace existing file with new sequential and formatted file</span>
<span class="w">                        </span><span class="n">IOUnit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetNewIOUnit</span><span class="p">()</span>
<span class="w">                        </span><span class="k">OPEN</span><span class="p">(</span><span class="n">UNIT</span><span class="o">=</span><span class="n">IOUnit</span><span class="p">,</span><span class="w"> </span><span class="k">FILE</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Name</span><span class="p">),</span><span class="w"> </span><span class="n">STATUS</span><span class="o">=</span><span class="s1">&#39;REPLACE&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">ACTION</span><span class="o">=</span><span class="s1">&#39;READWRITE&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                             </span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">iStat</span><span class="p">,</span><span class="w"> </span><span class="n">IOMSG</span><span class="o">=</span><span class="n">cMsg</span><span class="p">)</span>
<span class="w">                    </span><span class="k">ELSE</span>
<span class="w">                        </span><span class="c">! replace existing file with new direct access and unformatted file</span>
<span class="w">                        </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">RecLen</span><span class="p">))</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                            </span><span class="n">IOUnit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetNewIOUnit</span><span class="p">()</span>
<span class="w">                            </span><span class="k">OPEN</span><span class="p">(</span><span class="n">UNIT</span><span class="o">=</span><span class="n">IOUnit</span><span class="p">,</span><span class="w"> </span><span class="k">FILE</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Name</span><span class="p">),</span><span class="w"> </span><span class="n">STATUS</span><span class="o">=</span><span class="s1">&#39;REPLACE&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">ACTION</span><span class="o">=</span><span class="s1">&#39;READWRITE&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                 </span><span class="nb">ACCESS</span><span class="o">=</span><span class="s1">&#39;DIRECT&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">RECL</span><span class="o">=</span><span class="n">RecLen</span><span class="p">,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">iStat</span><span class="p">,</span><span class="w"> </span><span class="n">IOMSG</span><span class="o">=</span><span class="n">cMsg</span><span class="p">)</span>
<span class="w">                        </span><span class="k">END IF</span>
<span class="k">                    END IF</span>
<span class="k">                END IF</span>
<span class="k">            ELSE</span>
<span class="w">                </span><span class="c">! technical note #3</span>
<span class="w">                </span><span class="n">IOUnit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetNewIOUnit</span><span class="p">()</span>
<span class="w">                </span><span class="k">OPEN</span><span class="p">(</span><span class="n">UNIT</span><span class="o">=</span><span class="n">IOUnit</span><span class="p">,</span><span class="w"> </span><span class="k">FILE</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Name</span><span class="p">),</span><span class="w"> </span><span class="n">STATUS</span><span class="o">=</span><span class="s1">&#39;OLD&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">ACTION</span><span class="o">=</span><span class="s1">&#39;READWRITE&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                     </span><span class="n">POSITION</span><span class="o">=</span><span class="s1">&#39;ASIS&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">iStat</span><span class="p">,</span><span class="w"> </span><span class="n">IOMSG</span><span class="o">=</span><span class="n">cMsg</span><span class="p">)</span>
<span class="w">            </span><span class="k">END IF</span>
<span class="w">            </span>
<span class="w">            </span><span class="c">! check I/O status</span>
<span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">iStat</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">                CALL </span><span class="n">Output_Message</span><span class="p">(</span><span class="s1">&#39;---            WARNING ERROR MESSAGE            ---&#39;</span><span class="p">)</span>
<span class="w">                </span><span class="k">CALL </span><span class="n">Output_Message</span><span class="p">(</span><span class="s1">&#39;Cannot open &#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">Name</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s1">&#39; for reading and writing.&#39;</span><span class="p">)</span>
<span class="w">                </span><span class="k">CALL </span><span class="n">Output_Message</span><span class="p">(</span><span class="s1">&#39;IOSTAT = &#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">ToChar</span><span class="p">(</span><span class="n">iStat</span><span class="p">))</span>
<span class="w">                </span><span class="k">CALL </span><span class="n">Output_Message</span><span class="p">(</span><span class="s1">&#39;IOMSG  = &#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">cMsg</span><span class="p">)</span><span class="w"> </span>
<span class="w">                </span><span class="k">CALL </span><span class="n">Output_Message</span><span class="p">(</span><span class="s1">&#39;---------------------------------------------------&#39;</span><span class="p">)</span>
<span class="w">                </span><span class="n">IOUnit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">            </span><span class="k">END IF</span>
<span class="k">        END IF</span>
<span class="k">    ELSE</span>
<span class="w">        </span><span class="c">! technical note #1</span>
<span class="w">        </span><span class="n">IOUnit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OpenNewFile</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span><span class="n">DirAcc</span><span class="p">,</span><span class="n">RecLen</span><span class="p">)</span>
<span class="w">    </span><span class="k">END IF</span>
<span class="k">    </span>
<span class="k">    RETURN</span>
<span class="k">   </span>
<span class="k">END FUNCTION </span><span class="n">OpenFile</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col"><p>eXPerimental Fortran Library (XpfLib) Documentation was developed by Niranama<br>&copy; 2024 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>    

    <!-- MathJax JavaScript
             ================================================== -->
             <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
          jax: ['input/TeX','input/MathML','output/HTML-CSS'],
          extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
          });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

          <script src="../tipuesearch/tipuesearch_content.js"></script>
          <script src="../tipuesearch/tipuesearch_set.js"></script>
          <script src="../tipuesearch/tipuesearch.js"></script>

  </body>
</html>